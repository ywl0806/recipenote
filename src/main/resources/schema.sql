drop table if exists affiliate CASCADE;
drop table if exists comment CASCADE;
drop table if exists ingredient CASCADE;
drop table if exists recipe CASCADE;
drop table if exists recipe_ingredient CASCADE;
drop table if exists role CASCADE;
drop table if exists store CASCADE;
drop table if exists user CASCADE;
drop table if exists user_role CASCADE;
create table affiliate (id bigint generated by default as identity, created_at timestamp, updated_at timestamp, description varchar(255) not null, name varchar(255) not null, primary key (id));
create table comment (id bigint generated by default as identity, created_at timestamp, updated_at timestamp, description varchar(255) not null, recipe_id bigint not null, user_id bigint not null, primary key (id));
create table ingredient (id bigint generated by default as identity, created_at timestamp, updated_at timestamp, name varchar(255) not null, price integer, primary key (id));
create table recipe (id bigint generated by default as identity, created_at timestamp, updated_at timestamp, thumbnail_path varchar(255) ,affiliate_id bigint,is_public boolean not null, content varchar(1000) not null, name varchar(255) not null, store_id bigint, user_id bigint not null, primary key (id));
create table recipe_ingredient (recipe_id bigint not null, ingredient_id bigint not null, primary key (recipe_id, ingredient_id));
create table role (id bigint generated by default as identity, name varchar(255) not null, primary key (id));
create table store (id bigint generated by default as identity, created_at timestamp, updated_at timestamp, affiliate_id bigint not null, description varchar(255), latitude double, longitude double, name varchar(255) not null, primary key (id));
create table user (user_id bigint generated by default as identity, created_at timestamp, updated_at timestamp, affiliate_id bigint, enabled boolean not null, name varchar(255) not null, password varchar(255) not null, username varchar(255) not null, avatar_url varchar(255),primary key (user_id));
create table user_role (user_id bigint not null, role_id bigint not null, primary key (user_id, role_id));
alter table affiliate add constraint UK_k303s6m10cc5ybjcy470pkax8 unique (name);
alter table store add constraint UK_d0p5ly1cv6guij7sq1mbnr8ec unique (name);
alter table user add constraint UK_sb8bbouer5wak8vyiiy4pf2bx unique (username);
alter table comment add constraint FKe5i1rxybcm40jcn98fj1jmvit foreign key (recipe_id) references recipe;
alter table comment add constraint FK8kcum44fvpupyw6f5baccx25c foreign key (user_id) references user;
alter table recipe add constraint FKf6vfkhk3a391o4sdsk0w717wn foreign key (affiliate_id) references affiliate;
alter table recipe add constraint FK2fhnivbwc4v39wdq9lp3ryoam foreign key (store_id) references store;
alter table recipe add constraint FKc8o8io8s0f7nqcd3429u6cxjs foreign key (user_id) references user;
alter table recipe_ingredient add constraint FK9b3oxoskt0chwqxge0cnlkc29 foreign key (ingredient_id) references ingredient;
alter table recipe_ingredient add constraint FKgu1oxq7mbcgkx5dah6o8geirh foreign key (recipe_id) references recipe;
alter table store add constraint FKokmptx2g80t56urw269wcllvo foreign key (affiliate_id) references affiliate;
alter table user add constraint FK28qaihpqxupq5f6pjkgi683bb foreign key (affiliate_id) references affiliate;
alter table user_role add constraint FKa68196081fvovjhkek5m97n3y foreign key (role_id) references role;
alter table user_role add constraint FK859n2jvi8ivhui0rl0esws6o foreign key (user_id) references user;
